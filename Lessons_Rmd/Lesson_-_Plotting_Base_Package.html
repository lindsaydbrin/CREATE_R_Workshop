<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Plotting with the base package</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Plotting with the base package</h1>

</div>


<hr />
<ul>
<li><a href="#motivation">What, and why?</a><br />
</li>
<li><a href="#scatterplots">Scatterplots</a>
<ul>
<li><em><a href="#challengeScatter">Challenge</a></em></li>
<li><a href="#aesthetics">Plot structure and aesthetics</a></li>
<li><a href="#plotPar"><code>plot</code> and <code>par</code></a>
<ul>
<li><em><a href="#challengeAes">Challenge</a></em></li>
</ul></li>
<li><a href="#buildUp">Building up plots</a>
<ul>
<li><em><a href="#challengeBuildUp">Challenge</a></em></li>
</ul></li>
<li><a href="#plotText">Plotting text</a></li>
</ul></li>
<li><a href="#barPlots">Bar plots</a></li>
<li><a href="#outputPlots">Outputting plots</a></li>
<li><a href="#ggplot2">The next step: ggplot2</a></li>
<li><a href="#resources">Resources</a></li>
</ul>
<hr />
<div id="motivation" class="section level1">
<h1>Why, and what?</h1>
<p>Data is most useful when it can be communicated to others - and a picture is worth a thousand words! Being able to make clean, clear plots is essential to scientific communication. Being able to do so within R gives you some advantages, including being able to automate creation of multiple similar plots, and to very easily recreate a plot when your data change. Furthermore, if you can create plots quickly and easily, you have access to powerful tools for exploring your data.</p>
<p>There are multiple options for approaches to creating plots in R, including using packages such as <code>ggplot2</code>, <code>ggvis</code>, and <code>lattice</code>, which extend the capabilities of the base plotting functions. However, it is still incredibly useful to understand how to work with the base graphics plotting functions, and even more so if you are using packages that rely on these functions. So, we will start with plotting in the base graphics package, and then introduce you to <code>ggplot2</code>.</p>
<p>The goal of this lesson is to give you experience making and formatting plots so that you are comfortable looking up details on any plot you might want to make in the future. To this end, we will start by going into detail on formatting plots while working with a scatterplot, to give you a picture of how an R-generated plot could become a publication quality figure. We will then use barplots to demonstrate how you can use some of the formatting tools from the scatterplot section on other kinds of plots. We will conclude with some tips on outputting plots to pdf, which will help you make figures that you can sumbit to journals for publication.</p>
</div>
<div id="scatterplots" class="section level1">
<h1>Scatterplots</h1>
<p>Scatterplots can be made with the function <code>plot</code>, and only require x and y vectors to be plotted against each other. As an example, let’s create two vectors and plot them against each other.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a vector of 50 random numbers</span>
    xvalues &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">50</span>)
<span class="co"># Create a vector of 50 lower numbers </span>
    yvalues &lt;-<span class="st"> </span>xvalues/<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">50</span>)

<span class="co"># Plot these vectors against each other</span>
    <span class="kw">plot</span>(xvalues, yvalues)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-2-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>We can also plot variables that are contained within a data frame. Let’s read in a data file of fake fruit heights and weights.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read in data</span>
    fruitData &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;Data/fruitData.csv&quot;</span>)

<span class="co"># Take a look at the data frame structure</span>
    <span class="kw">str</span>(fruitData) </code></pre></div>
<pre><code>## &#39;data.frame&#39;:    200 obs. of  3 variables:
##  $ fruitHeight: num  7.07 7.05 6.93 6.98 7.36 ...
##  $ fruitWeight: num  80 80.3 80.1 80.7 81.2 ...
##  $ fruitType  : Factor w/ 2 levels &quot;Apple&quot;,&quot;Pear&quot;: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>It looks like we have height and weight data for both apples and pears. Let’s plot weight against height. We can do this by specifying our vectors as variables within the data frame, i.e. by using <code>$</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot fruit height and weight</span>
    <span class="kw">plot</span>(fruitData$fruitHeight, fruitData$fruitWeight)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-5-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>The <code>x</code> and <code>y</code> arguments in this function call are quite long, and somewhat difficult to read quickly. If you were making many plots of variables within <code>fruitData</code>, you might want a cleaner way to specify the variables to be plotted.</p>
<p>To do this, we can pass data to the <code>plot</code> function by specifying the data set with the <code>data</code> argument, and then specifying the x and y variables with only the variable names. This is the basic format (where <code>x</code>, <code>y</code>, and <code>yourDataFrame</code> would be substituted with the names of your x variable, y variable, and data frame respectively):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(y ~<span class="st"> </span>x, <span class="dt">data=</span>yourDataFrame)</code></pre></div>
<p>Note that the order of the variables is switched from <code>x, y</code> to <code>y ~ x</code>! This command can be thought of as “plot y against x.” To recreate the above plot exactly, we would use the following code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitWeight ~<span class="st"> </span>fruitHeight, <span class="dt">data=</span>fruitData)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-7-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<div id="challengeScatter" class="section level4">
<h4>Challenge</h4>
<ol style="list-style-type: decimal">
<li><p>Using the <code>metals</code> data frame from the lesson on joins, plot Pb concentrations against Cu concentrations. Then plot Pb concentrations against Fe concentrations.</p></li>
<li><p>The syntax where the data set is specified only once in the plot function can make it simpler to plot subsets of data. Using what you learned about subsetting with <code>dplyr</code>, make a scatterplot of fruit weight versus fruit height using only data on pears, i.e., by specifying the appropriate data set in the <code>data</code> argument of the plot function.</p></li>
</ol>
</div>
<div id="aesthetics" class="section level2">
<h2>Plot structure and aesthetics</h2>
</div>
<div id="plot-and-par" class="section level2">
<h2><code>plot</code> and <code id="plotPar">par</code></h2>
<p>There are many options for modifying the structure and aesthetics of a plot. To start, we can modify options given in the <code>plot</code> function, which you can learn about through the help file using <code>?plot</code>.</p>
<p>Let’s work with the <code>nutrients</code> data frame from the earlier dplyr lessons. Try plotting ammonium concentration versus nitrate concentration, and look at the help file to specify <code>type</code> to be both points and lines and to label the x and y axes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>
         , <span class="dt">xlab=</span><span class="st">&quot;Nitrate concentration&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Ammonium concentration&quot;</span>)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-10-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>Of course, lines don’t make a lot of sense in this context, but it is helpful to know that this option exists!</p>
<p>R picks axis limits based on the values being plotted. The default is to increase the range by 4% and then pick axis limits. However, we usually want to have axes start at 0, and end at a nice round number. To do this, we can specify the x and y axis limits, using the arguments <code>xlim</code> and <code>ylim</code>. Each of these arguments requires a two-element vectors that specifies the beginning and end of the axes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>)
         , <span class="dt">xlab=</span><span class="st">&quot;Nitrate concentration&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Ammonium concentration&quot;</span>)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-11-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>This is already starting to look a bit better!</p>
<p>We have many more options for modifying “parameters,” which can be passed to the plot function. For a list of these, type <code>?par</code>. The help file will tell you that some parameters can only be set by a separate call to <code>par()</code>, including parameters that have to do with layout and spacing of the plots. We will look at some of these later. Other, graphical parameters, can be passed to plot functions, and these are the ones we will look at now.</p>
<p>Here are some of the more commonly used parameters:</p>
<ul>
<li><code>col</code> - point/line <strong>col</strong>or
<ul>
<li>Color names, such as “red”, as well as hexadecimal color codes<br />
</li>
</ul></li>
<li><code>pch</code> - <strong>p</strong>oint <strong>ch</strong>aracter, or symbol shape
<ul>
<li>A number from 1-25, or a vector of numbers from 1-25 with length equal to the plotted vectors</li>
</ul></li>
<li><code>bg</code> - <strong>b</strong>ack<strong>g</strong>round color of the symbol, if applicable (pch between 21 and 25)</li>
<li><code>cex</code> - <strong>c</strong>haracter <strong>ex</strong>pansion, or point size
<ul>
<li>Magnification relative to the default (1); can be greater or less than 1</li>
</ul></li>
<li><code>lty</code> - <strong>l</strong>ine <strong>ty</strong>pe
<ul>
<li>A number from 0 to 6, which specify options like solid, dotted, or dashed</li>
</ul></li>
<li><code>lwd</code> - <strong>l</strong>ine <strong>w</strong>i<strong>d</strong>th
<ul>
<li>A positive number, where 1 is the default</li>
</ul></li>
<li><code>las</code> - rotation of tick labels
<ul>
<li>A number from 0 to 3; 1 keeps all labels horizontal</li>
</ul></li>
</ul>
<p>There are 25 different symbols that can be specified by <code>pch</code>. You can quickly look at all of them by making a plot of 25 points with pch equal to 1:25, as below. Let’s also plot the points in red, with a gray background, to demonstrate how <code>col</code> and <code>bg</code> are used to specify symbol colors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">25</span>, <span class="dv">1</span>:<span class="dv">25</span>, <span class="dt">pch=</span><span class="dv">1</span>:<span class="dv">25</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">bg=</span><span class="st">&quot;gray&quot;</span>)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-12-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>You can see that <code>col</code> specifies point color, but sometimes this refers to the outline of an open symbol. For <code>pch</code> = 21 through 25, <code>bg</code> specifies the fill color of the point.</p>
<div id="challengeAes" class="section level4">
<h4>Challenge</h4>
<ol start="3" style="list-style-type: decimal">
<li>Using the nutrient data, make a plot of ammonium versus nitrate data that specifies all of the above parameters. Try a few different values for each.</li>
</ol>
</div>
</div>
<div id="buildUp" class="section level2">
<h2>Building up plots</h2>
<p>You may have noticed that every time we use the <code>plot</code> function, a new plot is drawn. This is known as a “high level” plotting function. There are other, “lower level”, plotting functions that can add additional things to the plot, such as lines, points, legends, axes, or text. Defining the plot space and then adding layers to the plot will allow you to have finer-grained control over the contents and aesthetics of your plot.</p>
<p>For example, if we wanted to add the nitrite data to the plot of ammonium versus nitrate concentration above, we could use the <code>points</code> function. To visually separate the sets of data, we will define separate colors for each. We’ll also go back to the default of using only points, and specify <code>pch = 19</code>, a solid point, and <code>las = 1</code> for horizontal tick labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>)
         , <span class="dt">xlab=</span><span class="st">&quot;Nitrate concentration&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Ammonium concentration&quot;</span>, <span class="dt">las=</span><span class="dv">1</span>)
<span class="kw">points</span>(Nitrite ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-13-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>Notice that with the second set of points, the y-axis label no longer makes sense. We could specify the axis label in the initial plot command, but we have more control if we add it separately. It would also be nice to adjust the placement of the x and y axes. So let’s take another approach, and plot different components of the plot separately from each other.</p>
<p>We will start by plotting a blank plot that sets the plot bounds. We will do this by setting <code>type</code>=“n” to keep points from being plotted, setting <code>axes</code> to FALSE to keep the axes from being plotted, and specifying <code>ann</code> (annotations) as FALSE to suppress axis labels. We will then add axes with the <code>axis</code> function, and then points with <code>points</code>. Try this yourself, and run one line at a time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>), <span class="dt">type=</span><span class="st">&quot;n&quot;</span>, <span class="dt">ann=</span><span class="ot">FALSE</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>)  <span class="co"># Make empty plot</span>
  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)  <span class="co"># Add x-axis</span>
  <span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)  <span class="co"># Add y-axis</span>
  <span class="kw">points</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  <span class="co"># Add ammonium points</span>
  <span class="kw">points</span>(Nitrite ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)  <span class="co"># Add nitrite points</span></code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-14-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>The <code>axis</code> function has many optional parameters. The help file (<code>?axis</code>) gives you a list, and also notes that other graphical <code>par</code>ameters can be passed to this function. The one required argument is <code>side</code>. Plot sides are represented by a number from 1 to 4, where 1 is the bottom, and the numbering goes clockwise around the plot (i.e., the left side is 2). This makes it straightforward to add a separate axis on the right side, i.e. by specifying <code>side=4</code>.</p>
<p>Another helpful argument is <code>pos</code> (position), which allows you to control where the axis is in terms of its intersection with the perpendicular axis. Try adding another y-axis at x=2 to understand how this works.</p>
<p>We could also have accomplished something similar with the <code>line</code> argument, which tells the function how far into the margin, and therefore away from the plot, to put the axis. Line numbers start at the axis and move outward, and do not need to be whole numbers.</p>
<p>Last, as above, <code>las</code> specifies the rotation of the tick labels, where 1 means parallel to the reading direction.</p>
<p>Now that we have our plot, we can add axis labels using <code>mtext</code>. In particular, if we use the function <code>expression</code> rather than just a character string, we can incorporate text formatting like subscripts, superscripts, and greek letters. <code>expression</code> takes a vector of objects, such as strings (in quotes), or variables denoting Greek letters, and other symbols that determine how the components are connected. For example, you can use * for simple concatenation, ^ for a superscript, or enclose the text with [ ] for a subscript.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>), <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>)  
  <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)
    <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Nitrate concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">1</span>
                , <span class="dt">line=</span><span class="dv">2</span>)  <span class="co"># Label x-axis</span>
  <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)  
    <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">2</span>
                , <span class="dt">line=</span><span class="dv">2</span>)  <span class="co"># Label y-axis</span>
  <span class="kw">points</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
  <span class="kw">points</span>(Nitrite ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-15-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>Now let’s add a legend. You can do this with the <code>legend</code> function. Important arguments to the <code>legend</code> function include those that specify its position, the legend text, the line size or point type, and the symbol colors. For the position, you can specify <code>x</code> and <code>y</code> with values, or you can give descriptive strings to <code>x</code>: “topright”, “topleft”, “bottomright”, “bottomleft”, and “center”. We’ll specify the position with coordinates.</p>
<p>Also, note that <code>pch</code> can be given as a single integer, which will be applied to all points, or as a vector specifying the symbol for each point in the legend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>), <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>)  <span class="co"># Make empty plot</span>
  <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)
    <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Nitrate concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">2</span>) 
  <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>) 
    <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">2</span>) 
  <span class="kw">points</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)    
  <span class="kw">points</span>(Nitrite ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)  
  <span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.1</span>, <span class="dt">y=</span><span class="dv">14</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Ammonium&quot;</span>, <span class="st">&quot;Nitrate&quot;</span>), <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>))  <span class="co"># Add legend</span></code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-16-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>Notice that the legend is not connected to the contents of the plot. This means that you have to carefully check that you’ve specified the colors, lines, etc. correctly, to avoid displaying the wrong information. However, it also means that you have more control on the legend contents and formatting.</p>
<p>Take a look at <code>?legend</code> for details on things like specifying text size and line spacing, removing the border or background, etc.</p>
<div id="challengeBuildUp" class="section level4">
<h4>Challenge</h4>
<ol start="4" style="list-style-type: decimal">
<li>Make a plot that is similar to the one above, but plot different symbols for different values of <code>Treatment</code>.</li>
</ol>
</div>
</div>
<div id="plotText" class="section level2">
<h2>Plotting text</h2>
<p>Sometimes it is useful to add text to a plot, e.g. to add panel letters or equations, or to add lowercase letters that specify statistical differences. You can use the function <code>text</code> to do this.</p>
<p><code>text</code> is very similar to <code>points</code>. It requires arguments that specify the location (<code>x</code> and <code>y</code>) of the text and the <code>label</code>s, or the text itself, and these vectors must all be the same length. <code>text</code> can also take arguments specifying other optional <code>par</code>ameters. Just for fun, let’s try plotting the data as numbers corresponding to the sample replicates, instead of points.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>), <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>)
  <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)
    <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Nitrate concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">2</span>) 
  <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>) 
    <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">2</span>) 
  <span class="kw">text</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">labels=</span>Replicate, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)  <span class="co"># Add text instead of points</span>
  <span class="kw">text</span>(Nitrite ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">labels=</span>Replicate, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)  <span class="co"># Add text instead of points </span>
  <span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">0.1</span>, <span class="dt">y=</span><span class="dv">14</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Ammonium&quot;</span>, <span class="st">&quot;Nitrate&quot;</span>), <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>)) </code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-17-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>We can conclude from this plot that if you try to make up random numbers for concentrations, you may still end up following a subconscious pattern!</p>
</div>
</div>
<div id="barPlots" class="section level1">
<h1>Bar plots</h1>
<p>Let’s try plotting a bar plot showing mean concentrations of each nutrient. First, we need to summarize the data to find the values to plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nutrients_mean &lt;-<span class="st"> </span>nutrients %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(Treatment) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Ammonium=</span><span class="kw">mean</span>(Ammonium), <span class="dt">Nitrate=</span><span class="kw">mean</span>(Nitrate), <span class="dt">Nitrite=</span><span class="kw">mean</span>(Nitrite))
nutrients_mean</code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   Treatment Ammonium Nitrate   Nitrite
##       &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;
## 1         1 9.066667     2.7 0.9000000
## 2         2 8.966667     2.4 0.9333333</code></pre>
<p>Now that we have a table that gives us the mean value for each nutrient for each concentration, we can plot these values. The function <code>barplot</code> require matrices as input, and will plot all values in the matrix. We can use <code>select</code> to choose only the variables we want to plot, and <code>as.matrix</code> to convert to a matrix, and we can do this within the argument to the barplot function to avoid creating a separate, intermediate data frame.</p>
<p>When we call the function <code>barplot</code>, it will plot each variable (column) separately, and group observations (rows) within each variable. The default is to make a stacked bar plot, with each bar made of the rows within a variable.</p>
<p>As with scatterplots, we can include an axis label and specify parameters, such as <code>las=1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(nutrients_mean %&gt;%
<span class="st">          </span><span class="kw">select</span>(Ammonium, Nitrate, Nitrite) %&gt;%
<span class="st">          </span><span class="kw">as.matrix</span>() 
                , <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">ylab=</span><span class="st">&quot;Concentration&quot;</span>)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-19-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>We probably don’t want a stacked bar plot here - it would make more sense to have the bars next to each other. To do that, we can specify <code>beside=TRUE</code>. To help with spacing, we will also specify the space between each set of bars, using <code>space</code>. For multiple bars in each group, <code>space</code> is a vector with two values, where the first value is the space between bars within the group, and the secong value is the space between groups, both as a fraction of the bar width. We’ll separate the bars within the groups just a little bit.</p>
<p>We can also set the y-axis limits as with a scatterplot, make the tick labels parallel to the reading direction.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(nutrients_mean %&gt;%
<span class="st">          </span><span class="kw">select</span>(Ammonium, Nitrate, Nitrite) %&gt;%
<span class="st">          </span><span class="kw">as.matrix</span>() 
        , <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">space=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">ylab=</span><span class="st">&quot;Concentration&quot;</span>)</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-20-1.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>And last, as with scatterplots, we can add a legend to differentiate between treatments. Remember that you have to specify the colors in a legend, so it’s important to be sure that you get this right!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">barplot</span>(nutrients_mean %&gt;%
<span class="st">          </span><span class="kw">select</span>(Ammonium, Nitrate, Nitrite) %&gt;%
<span class="st">          </span><span class="kw">as.matrix</span>() 
        , <span class="dt">beside=</span><span class="ot">TRUE</span>, <span class="dt">space=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="dv">1</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>), <span class="dt">las=</span><span class="dv">1</span>, <span class="dt">ylab=</span><span class="st">&quot;Concentration&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">pch=</span><span class="dv">22</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">pt.bg=</span><span class="kw">gray.colors</span>(<span class="dv">2</span>), <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Treatment 1&quot;</span>, <span class="st">&quot;Treatment 2&quot;</span>))</code></pre></div>
<p><img src="Images/BasePlotImages/unnamed-chunk-21-1.png" width="600pt" style="display: block; margin: auto;" /></p>
</div>
<div id="outputPlots" class="section level1">
<h1>Outputting plots</h1>
<p>When we plot in R, the plot is drawn in a separate window, or graphics device. In RStudio, unless we specify otherwise, this graphics device is the Plots window. You can export a plot in a variety of different formats, but this can become inconvenient as you make changes to your plot, and the relative dimensions of the plot may change depending on the size of your window or the exported file.</p>
<p>A more direct way to create an external figure is to open a file of the type that you prefer (pdf, png, etc.), and plot to it directly. Technically, this means that you are opening a separate graphics device, plotting to it, and then closing it. One benefit of this approach is that you can specify the dimensions of this file, as well as its layout, margins, and other characteristics, and know that they will be consistent every time.</p>
<p>The way to open a file differs between a Mac and a PC. On a Mac, you can use the <code>quartz</code> function for all kinds of files, as long as you specify the file <code>type</code>. On a PC, you need use different functions for different file types; for a pdf, you can use <code>pdf</code>. (This function works on a Mac as well.) In either case, you will need to specify the name of the file with <code>file</code>, as well as its dimensions. You can also specify other characteristics, such as the font <code>pointsize</code>.</p>
<p>Creating an 8.5 x 11 file will be helpful for visualizing the plot on a standard sheet of paper. Even if you don’t intend to print the plot, however, it is still useful to be able to specify dimensions, because (1) the relative dimensions of the plot and its contents (text size, point size, line width) will be the same time every time you plot it, and (2) you can more easily maintain a consistent design across multiple plots.</p>
<p>For example, to open a pdf file, you can run one of the following functions:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use ONE of the following functions to open a new graphics device</span>
<span class="co"># (and only run it once, to avoid opening multiple files!).</span>

<span class="co"># On a Mac, use quartz() for many file types, and specify with type.</span>
    <span class="kw">quartz</span>(<span class="dt">type=</span><span class="st">&quot;pdf&quot;</span>, <span class="dt">file=</span><span class="st">&quot;Figures/Fruits.pdf&quot;</span>, <span class="dt">height=</span><span class="dv">11</span>, <span class="dt">width=</span><span class="fl">8.5</span>, <span class="dt">pointsize=</span><span class="dv">14</span>)

<span class="co"># On a PC, use pdf() to open a pdf file.</span>
<span class="co"># This function also works on a Mac.</span>
    <span class="kw">pdf</span>(<span class="dt">file=</span><span class="st">&quot;Figures/Fruits.pdf&quot;</span>, <span class="dt">height=</span><span class="dv">11</span>, <span class="dt">width=</span><span class="fl">8.5</span>, <span class="dt">pointsize=</span><span class="dv">14</span>)
    
<span class="co"># In either case, be sure the file name is appropriate for your own file structure!</span></code></pre></div>
<p>Once you’ve opened your file, anything you plot will go to this file rather than to the plot window in RStudio.</p>
<p>In this case, we’d like to put two different plots on the pdf page, so we need to tell R how to place the plots. This involves two components: the placement of the plots in a grid, and the margins around each plot. We can do both of these, as well as determine the margins for the overall document, with a call to <code>par()</code>.</p>
<p>Within the function <code>par()</code>, we can specify the margins around each plot with the argument <code>mar</code> (“margins”) and for the entire document with the argument <code>omi</code> (“outer margin in inches”). Both of these require a vector with four integers, specifying margins on all sides, starting at the bottom and going clockwise. If you want to plot multiple plots, you can also specify the number of rows and columns with <code>mfrow</code>, which takes a vector with two integers, of the form c(#rows, #cols) (i.e., number of rows and then number of columns). (If you only want to plot one plot, you can skip the <code>mfrow</code> argument.) For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">omi=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</code></pre></div>
<p>This sets R up to create a document with plots in 2 rows and 1 columns (<code>mfrow</code>). The margin for the whole page (<code>omi</code>) is a bit bigger on the bottom than the other sides, and the margin for each figure (<code>mar</code>) is larger on the bottom and the left, to make room for the axes and axis labels. Note that <code>par()</code> with <code>mfrow</code>, <code>mar</code>, and <code>omi</code> can be used within the RStudio graphics device as well, to put multiple plots on the same page layout.</p>
<p>After you have opened your device and set up your margins and plot layout, it’s time to make your plots, i.e. with <code>plot()</code> or other plotting functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(fruitWeight ~<span class="st"> </span>fruitHeight, <span class="dt">data =</span> fruitData %&gt;%<span class="st"> </span><span class="kw">filter</span>(fruitType ==<span class="st"> &quot;Pear&quot;</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;lightgreen&quot;</span>)
    <span class="kw">mtext</span>(<span class="dt">text =</span> <span class="st">&quot;Pears&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">1</span>)
<span class="kw">plot</span>(fruitWeight ~<span class="st"> </span>fruitHeight, <span class="dt">data =</span> fruitData %&gt;%<span class="st"> </span><span class="kw">filter</span>(fruitType ==<span class="st"> &quot;Apple&quot;</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>)
    <span class="kw">mtext</span>(<span class="dt">text =</span> <span class="st">&quot;Apples&quot;</span>, <span class="dt">side =</span> <span class="dv">3</span>, <span class="dt">line =</span> <span class="dv">1</span>)</code></pre></div>
<p>Once you are done, you need to close the plotting device using <code>dev.off()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dev.off</span>()</code></pre></div>
<p>Then, voila! Your plot is in pdf form. The above code will produce something like this:</p>
<p><img src="Images/Fruits.png" width="600pt" style="display: block; margin: auto;" /></p>
<p>(The above image is in .png form to sidestep issues with some browsers not rendering pdfs properly.)</p>
<p>Below is an example of code for the entire process (opening the device, drawing the plots, and closing the device), to make a plot called <code>Nutrients.pdf</code> that has two side by side plots (1 row with 2 columns) showing <code>Ammonium</code> or <code>Nitrite</code> concentrations versus <code>Nitrate</code> concentrations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make a pdf file with two plot panels: </span>
<span class="co">#  Ammonium vs. nitrate</span>
<span class="co">#  Nitrite vs. nitrate</span>

<span class="kw">pdf</span>(<span class="dt">file=</span><span class="st">&quot;Figures/Nutrients.pdf&quot;</span>, <span class="dt">height=</span><span class="dv">11</span>, <span class="dt">width=</span><span class="fl">8.5</span>, <span class="dt">pointsize=</span><span class="dv">12</span>)

  <span class="co"># Specify outer margins, plot margins, and plot layout</span>
    <span class="co"># Note that the omi argument specified here gives a very large bottom margin,</span>
    <span class="co">#  since we want our two plots at the top of the page.</span>
    <span class="kw">par</span>(<span class="dt">omi=</span><span class="kw">c</span>(<span class="dv">7</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))

  <span class="co"># Make ammonium plot</span>
  <span class="co"># It doesn&#39;t matter what values we plot in the plot() function, </span>
  <span class="co">#     since type is set to &quot;n&quot; (no plotting), and the points are added with points().</span>
    <span class="kw">plot</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>), <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)
      <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)
        <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Nitrate concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">2</span>) 
      <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>) 
        <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Ammonium concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">2</span>) 
      <span class="kw">points</span>(Ammonium ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)

  <span class="co"># Make nitrite plot</span>
    <span class="kw">plot</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">14</span>), <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;&quot;</span>, <span class="dt">axes=</span><span class="ot">FALSE</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)
      <span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>)
        <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Nitrate concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">2</span>) 
      <span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">pos=</span><span class="dv">0</span>, <span class="dt">las=</span><span class="dv">1</span>) 
        <span class="kw">mtext</span>(<span class="dt">text=</span><span class="kw">expression</span>(<span class="st">&quot;Nitrite concentration (&quot;</span>*mu*<span class="st">&quot;mol L&quot;</span>^<span class="st">&quot;-1&quot;</span>*<span class="st">&quot;)&quot;</span>), <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">2</span>) 
      <span class="kw">points</span>(Nitrite ~<span class="st"> </span>Nitrate, <span class="dt">data=</span>nutrients, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)

<span class="kw">dev.off</span>()</code></pre></div>
<p><br></p>
<p><img src="Images/Nutrients.png" width="600pt" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>(The above image is in .png form to sidestep issues with some browsers not rendering pdfs properly.)</p>
<p>You can run into problems when plotting to external graphics devices if you accidentally open more devices than you intend, or forget to close your devices. If you find that later plots are not being plotted properly, either within RStudio or to an external file, this may be because you have plotting devices open that you aren’t aware of. You can check which devices are open with <code>dev.list()</code>, and check which device is the current device (i.e., where your plots are being plotted) with <code>dev.cur()</code>. You can close specific devices using <code>dev.off()</code> with the argument <code>which</code> indicating the number of the graphics device that you want to close. I.e., if you want to close device 3, you can run <code>dev.off(which = 3)</code> or <code>dev.off(3)</code>.</p>
<hr />
</div>
<div id="ggplot2" class="section level1">
<h1>The next step: ggplot2</h1>
<p><code>ggplot2</code> is a package that contains functions that can simplify plotting, even for relatively advanced, complex, or multi-layered plots. Although we are not covering it in this course, it is a very good tool to learn.</p>
<p>There are many online resources for learning this package, including a highly recommended <a href="http://www.datacarpentry.org/R-ecology-lesson/05-visualization-ggplot2.html">Data Carpentry lesson on using ggplot2</a>; take a look at that lesson to get a sense of what <code>ggplot2</code> can do.</p>
<p>More info on <code>ggplot2</code> can be found on the <a href="http://ggplot2.org">official website</a>.</p>
<hr />
</div>
<div id="resources" class="section level1">
<h1>Resources</h1>
<p>The following pages may be helpful resources for making and formatting different kinds of plots:</p>
<ul>
<li><a href="http://www.statmethods.net/graphs/">Quick-R guide to basic graphs</a></li>
<li><a href="http://shinyapps.org/apps/RGraphCompendium/index.php">A Compendium of Clean Graphs in R</a></li>
<li><a href="http://rpubs.com/SusanEJohnston/7953">RStudio: R Base Graphics: An Idiot’s Guide</a></li>
</ul>
<br>
<hr>
<p><br></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
